<!-- inverted_pendulum.xml -->
<!-- Template for the MuJoCo model. Values in curly braces are substituted -->
<!-- from config.py at load time â€” config.py is the single source of truth. -->

<mujoco model="inverted pendulum">
	<compiler inertiafromgeom="true"/>
	<default>
		<!-- Joint damping of 0 -->
		<joint armature="0" damping="0" limited="true"/>
		<!-- Set sliding friction, torsional friction, and rolling friction to 0 -->
		<geom contype="0" friction="0 0 0" rgba="0.7 0.7 0 1"/>
	</default>
	<!-- No timestamp specified here because it's overwritten in environment.py -->
	<option gravity="0 0 -{gravity}" integrator="RK4"/>
	<size nkey="5" nuser_jnt="1"/>
	<worldbody>
		<!-- This is an invisible body that is not affected by physics. -->
		<!-- We will move it to follow the mouse cursor. -->
		<body name="target_mocap" mocap="true" pos="0 0 0" />

		<!-- Force circle: a mocap body that follows the mouse and collides with other bodies -->
		<body name="force_circle_mocap" mocap="true" pos="0 0 100">
			<geom name="force_circle" type="sphere" size="{force_circle_radius}" rgba="1 0 0 0"/>
		</body>

		<body name="cart" pos="0 0 0">
			<joint axis="1 0 0" limited="true" name="slider" pos="0 0 0" range="-{half_track} {half_track}" type="slide"/>
			<geom name="cart" pos="0 0 0" size="0.1 0.05 0.02" type="box" mass="4" contype="1"/>
			<body name="pole" pos="0 0 0">
				<joint axis="0 1 0" name="hinge" pos="0 0 0" type="hinge" limited="false"/>
				<!-- Pole rod: collision enabled so the force circle can push anywhere along the bar -->
				<geom fromto="0 0 0 0.001 0 {pole_length}" name="pole" size="0.049" mass="1" type="capsule" contype="1"/>
				<!-- Tip node: sphere at end of pole for collision with force circle -->
				<geom name="tip_node" type="sphere" pos="0 0 {pole_length}" size="{node_radius}" mass="0.05" contype="1"/>
			</body>
		</body>
	</worldbody>
	<actuator>
		<motor gear="1" joint="slider" name="slide"/>
	</actuator>

	<!-- DRAGGING -->
	<equality>
		<!-- This weld constraint forces the "cart" body to match the position -->
		<!-- of the "target_mocap" body when it is active. -->
		<!-- It is disabled by default (active="false"). -->
		<weld name="mocap_weld" body1="cart" body2="target_mocap" active="false" solimp="0.9 0.95 0.001" solref="0.02 1"></weld>
	</equality>
	<!-- ======================================================== -->
</mujoco>
